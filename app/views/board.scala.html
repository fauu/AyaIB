@(board: models.entities.Board,
  threads: List[models.entities.Thread],
  singleThreadView: Boolean = false,
  postForm: Form[models.forms.PostForm])(implicit flash: Flash)

@import helper._

@main("%s - %s".format(board.slashizedName, board.fullName)) {

  @flash.get("error").map { message =>
    <div>@message</div>
  }

  @flash.get("failure").map { _ =>
    <div>Internal error has occurred, please try again</div>
  }

  <main id="board">
    <header>
      <h2>
        <a href="@routes.BoardController.show(board.name)">
          @("%s - %s".format(board.slashizedName, board.fullName))
        </a>
      </h2>
    </header>
    <section id="threads">
    @if(singleThreadView) {
      @views.html.thread(board, threads.head, singleThreadView = true)
    } else {
      @for(thread <- threads) { @views.html.thread(board, thread) }
    }
    </section>
  </main>

  <aside id="post-form-container">
    @defining(
      if(singleThreadView) (routes.BoardController.postInThread(board.name, threads.head.op.no), "Reply")
      else (routes.BoardController.createThread(board.name), "Create thread")
    ) { case (actionUrl, actionName) =>
      @form(action = actionUrl, 'enctype -> "multipart/form-data") {
        @if(actionName == "Create thread") {
          @inputText(postForm("subject"), '_showConstraints -> false, 'placeholder -> "Subject")
        }
        @inputText(postForm("email"), '_showConstraints -> false, 'placeholder -> "E-mail")
        @textarea(postForm("content"), '_showConstraints -> false, 'placeholder -> "Message")
        @inputFile(postForm("file"))
        <button type="submit">@actionName</button>
      }
    }
  </aside>

}
